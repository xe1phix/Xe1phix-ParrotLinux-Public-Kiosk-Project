############################################
# Lab 2b: Not Enough Space (Negative Jump) #
############################################




## -------------------------------------------------------------------------------------------------------------- ##
##		[+]   Using-[.ASCII-Art.]-As-a-Visual-Aide.
##     [+]  -[ Metasploit ]-Exploiting-A-Vulberability-on-A-Vulnerable-Host
##     [+]  [ Metasploit ]~> Attack-Vector: ~>
##				-->  [ Negative-Jump ]-[ Buffer-Overflow ]-
##				-->  Then-[ NOP-Slide ]-To-The-Address-of-
##				-->  The-[ Instruction-Pointer ]-and-Shellcode-his-ass!
##     [?]  (Pentesting-Method-Explained-Using-ASCII-Art )
##     [?]  [ Buffer-Overflow.]-[.ASCII-Art.]-Attack-Breakdown-Art
## -------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- ##
 


-----------------------------------------------------------------------
 
[pad = distance_to_seh - len(shellcode) ] [ shellcode] [jmp4 = "\x90\x90\xEB\x04"] [eip (pop pop ret)] [jmp_min = "\xE9\x98\xEF\xFF\xFF"]
 
                                    ^
1 ----------------------1 overflow the buffer---------------------------|
                                   
                                    ^                    ^
                                    |
                                    2 ----jump over seh record---|
 
                                                     ^              ^  
                                                     |
                                                     3--POP 2 words off stack---|
 
                                                                    ^                  
4 -----negative jump into NOPs - then into shellcode -----------------------------------------------------------------------------------|

 
